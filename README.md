# python网页截图脚本（以可知PDF为例）📓

本脚本以可知PDF下载为例，抓取页面的元素进行截图，对图片统一消除水印，最后合成PDF。

## 📖简单说明

昨天找一本不常见的书，仅在可知平台上找到，淘宝代找也显示无资源。

可知平台的在线pdf阅读真的难用😫，还不能做笔记。虽然我对于网页方面并非精通，但还是决定写一简单的脚本去获取本地pdf，以获得更好的阅读体验。该脚本的思路并无技巧可言，对于大批量爬取也并不是很好的方案，但是个人的使用完全是没有问题的。

相对于传统的截图方案（如录制按键截图等）操作的不确定性，采用了更为准确的元素定位的截图模式，即使用python配合selenium库进行全自动的操作。

我不愿意，也不想去实现完全无水印的脚本，只是简单写了一个对于获取到本地的图片进行水印清除的代码，仅仅对于黑白文本有较好的效果。如果需要实现，应当考虑在网页端进行屏蔽。

## 🚀进度

### ✔️已实现

- [x] 抓取pdf元素转为图片
- [x] 简单消除水印
- [x] 图片转化为pdf

### ✖️未实现

- [ ] 网页端屏蔽水印（网页端很容易可以屏蔽）
- [ ] 彩色或灰度图消除半透明水印

## 📚使用介绍

### 🔍requestment.txt

```c
opencv_python==4.9.0.80
Pillow==10.2.0
selenium==4.18.1
```

### 🔨准备 Webdriver

本代码的运行需要搭配使用webdriver，推荐使用的是 [EdgeWebdriver](https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/?form=MA13LH) ，点击进入官网下载。
如果你需要使用其他浏览器，需要简单进行代码修改，详细操作自行搜索selenium的相关配置。

### 🔧参数配置

```python
# 参数设置
# webdriver，不同的浏览器不太相同，本代码只支持edge，chorm需要更改部分源码
edge_driver_path = r"xxxx\msedgedriver.exe"
# 文件暂时存放和生成的目录
temp_path = r'xxxx\temp'
# 可知在线阅读网页
url_str = 'xxxx'
# 每次页面滑动的步长，建议设置小一点，但是设置越小，消耗的时间越长
key_down_step = 5
# 页面最小高度，可以在页面元素里查到，或者将这个值设置为0，先获取一张完整的图像查看图片的高
min_height = 1405
# 去水印，使用粗糙的调节对比度和亮度的方法
is_clean_watermark = True  # 是否清除水印
alpha = 1  # 图片对比度调节
beta = 100  # 图片亮度调节
```
